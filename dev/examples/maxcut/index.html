<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Maximum Cut Problem · COSMO.jl</title><meta name="title" content="Maximum Cut Problem · COSMO.jl"/><meta property="og:title" content="Maximum Cut Problem · COSMO.jl"/><meta property="twitter:title" content="Maximum Cut Problem · COSMO.jl"/><meta name="description" content="Documentation for COSMO.jl."/><meta property="og:description" content="Documentation for COSMO.jl."/><meta property="twitter:description" content="Documentation for COSMO.jl."/><meta property="og:url" content="https://oxfordcontrol.github.io/COSMO.jl/stable/examples/maxcut/"/><meta property="twitter:url" content="https://oxfordcontrol.github.io/COSMO.jl/stable/examples/maxcut/"/><link rel="canonical" href="https://oxfordcontrol.github.io/COSMO.jl/stable/examples/maxcut/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-134239283-1"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-134239283-1', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><script src="../../assets/github_buttons.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="COSMO.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">COSMO.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../../jump/">JuMP Interface</a></li><li><a class="tocitem" href="../../lin_solver/">Linear System Solver</a></li><li><a class="tocitem" href="../../acceleration/">Acceleration</a></li><li><a class="tocitem" href="../../literate/build/custom_cone/">Custom Cone Constraint</a></li><li><a class="tocitem" href="../../decomposition/">Chordal Decomposition</a></li><li><a class="tocitem" href="../../literate/build/portfolio_model_updates/">Model Updates</a></li><li><a class="tocitem" href="../../literate/build/arbitrary_precision/">Arbitrary Precision</a></li><li><a class="tocitem" href="../../performance/">Performance Tips</a></li></ul></li><li><a class="tocitem" href="../../method/">Method</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../closest_correlation_matrix/">Closest Correlation Matrix</a></li><li><a class="tocitem" href="../logistic_regression/">Logistic Regression</a></li><li><a class="tocitem" href="../lovasz_petersen/">Lovász Theta Function</a></li><li><a class="tocitem" href="../lp/">Linear Program</a></li><li class="is-active"><a class="tocitem" href>Maximum Cut Problem</a><ul class="internal"><li><a class="tocitem" href="#Solving-the-primal-SDP"><span>Solving the primal SDP</span></a></li><li><a class="tocitem" href="#Solving-the-dual-SDP"><span>Solving the dual SDP</span></a></li><li><a class="tocitem" href="#Cholesky-factorisation-of-Y"><span>Cholesky factorisation of Y</span></a></li><li><a class="tocitem" href="#Rounding-the-approximate-solution"><span>Rounding the approximate solution</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="../portfolio_optimisation/">Portfolio Optimisation</a></li><li><a class="tocitem" href="../qp/">Quadratic Program</a></li><li><a class="tocitem" href="../sum_abs_k_eigenvalues/">Minimizing the sum of the k-largest λ</a></li><li><a class="tocitem" href="../svm_primal/">Support Vector Machine</a></li><li><a class="tocitem" href="../two_way_partitioning/">Relaxed Two-Way Partitioning Problem</a></li></ul></li><li><a class="tocitem" href="../../citing/">Citing COSMO</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Maximum Cut Problem</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Maximum Cut Problem</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oxfordcontrol/COSMO.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oxfordcontrol/COSMO.jl/blob/master/examples/maxcut.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p>The source files for all examples can be found in <a href="https://github.com/oxfordcontrol/COSMO.jl/tree/master/examples/">/examples</a>.</p><h1 id="Maximum-Cut-Problem"><a class="docs-heading-anchor" href="#Maximum-Cut-Problem">Maximum Cut Problem</a><a id="Maximum-Cut-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Cut-Problem" title="Permalink"></a></h1><p>We are interested in solving an approximation to the maximum cut problem using semidefinite programming. Consider the graph <span>$G(V,E)$</span> with weights <span>$w_{ij}$</span> shown below:</p><pre><code class="language-julia hljs"># create the weighted adjacency matrix of the graph and plot the graph
using LinearAlgebra, Plots, GraphRecipes
n = 4;
W = zeros(n, n);
W[1, 2] = 1; W[1, 4] = 8;
W[2, 3] = 2; W[2, 4] = 10;
W[3, 4] = 6;
W = Symmetric(W)
graphplot(W, names = 1:n, edgelabel = W,  x = [0; 1; 1; 0], y = [1; 1; 0; 0], fontsize = 12, nodeshape =:circle)</code></pre><img src="a77d05cb.svg" alt="Example block output"/><p>The maximum cut problem tries to find a cut or a partition of the graph&#39;s vertices into two complementary sets <span>$S$</span> and <span>$\bar{S}$</span> such that the total weight of the edges between the two sets is maximized. For this small graph the problem is trivial. The optimal solution is <span>$S = \{1,2,3 \}$</span> and <span>$\bar{S}=\{4\}$</span>. Formally, this problem can be written as a mixed-integer optimisation problem:</p><p class="math-container">\[\begin{array}{ll} \text{maximize} &amp;  \frac{1}{2} \sum_{i &lt; j} w_{ij}(1 - y_i y_j)\\
\text{subject to} &amp;  y_i \in \, \{-1, 1 \}, \quad \forall i \in V,
\end{array}\]</p><p>where <span>$y_i = 1$</span> indicates that <span>$v_i \in S$</span> and <span>$y_i = -1$</span> indicates that <span>$v_i \in \bar{S}$</span>. This problem is of interest in the field of integrated circuit design, where one tries to minimize the number of cross-layer connections in a circuit under layout constraints.</p><p>For more complicated graphs this problem quickly becomes hard to solve to optimality and in fact is known to be NP-hard. For this example we are interested in the randomized approximation algorithm that relaxes the problem to an SDP and was devised in Goemans and Williamson (1995) [1] (see for more details).</p><p>The approach can be divided into three steps:</p><ol><li>Solve a relaxed SDP to obtain <span>$Y^*$</span></li><li>Recover an approximate solution <span>$V$</span> via a Cholesky factorisation <span>$Y^* = V^\top V$</span></li><li>Round the approximate solution using a random vector <span>$r$</span> from the unit sphere.</li></ol><p>The authors showed that this approach guarantees a solution of at least <span>$0.87856$</span> times the optimal solution.</p><h2 id="Solving-the-primal-SDP"><a class="docs-heading-anchor" href="#Solving-the-primal-SDP">Solving the primal SDP</a><a id="Solving-the-primal-SDP-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-primal-SDP" title="Permalink"></a></h2><p>Before we formulate the SDP, let&#39;s compute the Laplacian matrix <span>$L$</span>:</p><pre><code class="language-julia hljs">using LinearAlgebra, Random, SparseArrays, COSMO, JuMP

rng = Random.MersenneTwister(1)

# Compute the Laplacian matrix of the graph
L = diagm(0 =&gt; W * ones(n)) - W;</code></pre><p>Given the Laplacian matrix <span>$L$</span>, we are looking for the optimal <span>$Y^*$</span> that solves the following SDP:</p><p class="math-container">\[\begin{array}{ll} \text{maximize} &amp;  \frac{1}{4} \langle L, Y \rangle \\
\text{subject to} &amp; Y_{ii} = 1 \quad \text{for } i = 1,\dots,n\\
                   &amp; Y \in \mathbf{S}_{+}^n.
\end{array}\]</p><p>Notice that the solution <span>$Y^*$</span> can be viewed as a correlation matrix. Let&#39;s solve the problem using COSMO and JuMP.</p><pre><code class="language-julia hljs">model = JuMP.Model(COSMO.Optimizer);
@variable(model, Y[1:n, 1:n], PSD);
@objective(model, Max, 1 / 4 * dot(L, Y));
@constraint(model, [i = 1:n], Y[i, i] == 1.);
JuMP.optimize!(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">------------------------------------------------------------------
          COSMO v0.8.9 - A Quadratic Objective Conic Solver
                         Michael Garstka
                University of Oxford, 2017 - 2022
------------------------------------------------------------------

Problem:  x ∈ R^{10},
          constraints: A ∈ R^{14x10} (14 nnz),
          matrix size to factor: 24x24,
          Floating-point precision: Float64
Sets:     DensePsdConeTriangle of dim: 10 (4x4)
          ZeroSet of dim: 4
Settings: ϵ_abs = 1.0e-05, ϵ_rel = 1.0e-05,
          ϵ_prim_inf = 1.0e-04, ϵ_dual_inf = 1.0e-04,
          ρ = 0.1, σ = 1e-06, α = 1.6,
          max_iter = 5000,
          scaling iter = 10 (on),
          check termination every 25 iter,
          check infeasibility every 40 iter,
          KKT system solver: QDLDL
Acc:      Anderson Type2{QRDecomp},
          Memory size = 15, RestartedMemory,
          Safeguarded: true, tol: 2.0
Setup Time: 0.1ms

Iter:	Objective:	Primal Res:	Dual Res:	Rho:
1	-5.2357e+02	3.6239e+01	1.9188e+00	1.0000e-01
25	-1.4267e+01	9.9925e-01	3.8141e-04	1.0000e-01
50	-1.4110e+01	8.5062e-04	1.4373e+01	6.0398e+02
75	-1.6187e+01	5.2176e-09	5.0000e+00	6.0398e+02
100	-2.4225e+01	3.5708e-01	2.4179e-03	2.4520e-02
125	-2.3310e+01	8.3645e-02	1.3578e-01	2.7809e+00
150	-2.4000e+01	8.5775e-10	1.7509e-11	2.7809e+00

------------------------------------------------------------------
&gt;&gt;&gt; Results
Status: Solved
Iterations: 176 (incl. 26 safeguarding iter)
Optimal objective: -24
Runtime: 0.271s (270.96ms)</code></pre><pre><code class="language-julia hljs">Yopt = JuMP.value.(Y);
obj_val = JuMP.objective_value(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">23.9999999938528</code></pre><h2 id="Solving-the-dual-SDP"><a class="docs-heading-anchor" href="#Solving-the-dual-SDP">Solving the dual SDP</a><a id="Solving-the-dual-SDP-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-dual-SDP" title="Permalink"></a></h2><p>Notice that the decision matrix <span>$Y$</span> is generally dense (as correctly classified in the solver output above). Therefore, we won&#39;t be able to utilize COSMO&#39;s chordal decomposition features. However, assuming strong duality, it turns out that we can also solve the dual problem, which is given by:</p><p class="math-container">\[\begin{array}{ll} \text{minimize} &amp;  \sum_i \gamma_i \\
\text{subject to} &amp; \text{diag}(\gamma) - \frac{1}{4} L = S \\
                  &amp; S \in \mathbf{S}_{+}^n.
\end{array}\]</p><p>As you can see, the matrix <span>$S$</span> is constrained to have zeros in places specified by the graph (Laplacian). Therefore, COSMO can try to decompose this SDP (see solver output) and speed up its algorithm:</p><pre><code class="language-julia hljs">model_dual = JuMP.Model(optimizer_with_attributes(COSMO.Optimizer, &quot;complete_dual&quot; =&gt; true));
@variable(model_dual, γ[1:n]);
@objective(model_dual, Min,  sum(γ));
@constraint(model_dual, lmi, Symmetric(-1/4 * L + diagm(γ)) in JuMP.PSDCone());
JuMP.optimize!(model_dual)
obj_val = JuMP.objective_value(model_dual)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">23.999999999767006</code></pre><p>The primal variable <span>$Y^*$</span> can be recovered from the dual variable associated with the LMI-constraint:</p><pre><code class="language-julia hljs">Yopt = dual(lmi)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4×4 LinearAlgebra.Symmetric{Float64, Matrix{Float64}}:
  1.0   1.0   1.0  -1.0
  1.0   1.0   1.0  -1.0
  1.0   1.0   1.0  -1.0
 -1.0  -1.0  -1.0   1.0</code></pre><p>To get the correct positive semidefinite dual variable, we have to enable PSD completion of the dual variable in COSMO. Now, that we have a solution we can perform the remaining steps in the approximation algorithm.</p><h2 id="Cholesky-factorisation-of-Y"><a class="docs-heading-anchor" href="#Cholesky-factorisation-of-Y">Cholesky factorisation of Y</a><a id="Cholesky-factorisation-of-Y-1"></a><a class="docs-heading-anchor-permalink" href="#Cholesky-factorisation-of-Y" title="Permalink"></a></h2><p>Compute the Cholesky factorisation of <span>$Y = V^\top V$</span> to find the unit vectors <span>$v_1, \dots, v_n$</span>.</p><pre><code class="language-julia hljs">factor = cholesky(Yopt, Val(true); check = false);
V = Matrix((factor.P * factor.L)&#39;);
# normalize columns
for i in 1:n
    V[:, i] ./= norm(V[:, i]);
end</code></pre><h2 id="Rounding-the-approximate-solution"><a class="docs-heading-anchor" href="#Rounding-the-approximate-solution">Rounding the approximate solution</a><a id="Rounding-the-approximate-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Rounding-the-approximate-solution" title="Permalink"></a></h2><p>It remains to round the unit vectors <span>$v_i$</span> using a random vector <span>$r$</span> with each component drawn from <span>$\mathcal{U}(0, 1)$</span>, to obtain the <span>$y_i$</span>&#39;s:</p><pre><code class="language-julia hljs">r = rand(rng, n)
r /= norm(r, 2)
y = ones(n)
for i in 1:n
  dot(r, V[:, i]) &lt;= 0 &amp;&amp; (y[i] = -1)
end
y</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element Vector{Float64}:
  1.0
  1.0
  1.0
 -1.0</code></pre><p>For larger graphs this rounding step could be repeated several times to improve the rounding. As expected <span>$S = \{1, 2, 3\}$</span> and <span>$\bar{S}=\{ 4\}$</span>.</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1] Goemans and Williamson - Improved Approximation Algorithms for Maximum Cut and Satisfiability Problems Using Semidefinite Programs (1995)</p><p>[2] Post-processing code steps 2 and 3 from this <a href="https://github.com/jump-dev/JuMP.jl/blob/master/examples/max_cut_sdp.jl">JuMP example</a></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lp/">« Linear Program</a><a class="docs-footer-nextpage" href="../portfolio_optimisation/">Portfolio Optimisation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Monday 6 May 2024 16:17">Monday 6 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
